<!DOCTYPE html>
<html>
<head>
  <title>Minesweeper</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
  
  <style type="text/css">
    * {
      padding: 0;
      margin: 0;
    }
    body {
    }
    @font-face {
      font-family: "lilliput steps";
      src: url("lilliput steps.ttf");
    }
    #borderBox {
      display: flex;
      margin: 10px;
      border-top: medium solid #ffffff;
      border-right: medium solid #7b7b7b;
      border-bottom: medium solid #7b7b7b;
      border-left: medium solid #ffffff;
      background-color: black;
      width: 268px;
      height: 311px;
    }
    .playBox {
      width: -webkit-fill-available;
      height: -webkit-fill-available;
      border-style: inset;
      border: medium solid #bdbdbd;
      border-width: 6px;
    }
    #timeBox {
      display: flex;
      width: -webkit-fill-available;
      height: 32px;
      border-style: inset;
      border-top: medium solid #7b7b7b;
      border-right: medium solid #ffffff;
      border-bottom: medium solid #ffffff;
      border-left: medium solid #7b7b7b;
      border-width: 2.4px;
      background-color: #c0c0c0;
    }
    .separator {
      display: flex;
      width: -webkit-fill-available;
      height: 6px;
      background-color: #c0c0c0;
    }
    #mineBox {
      display: flex;
      flex-wrap: wrap;
      width: 252px;
      height: 251px;
      border-top: medium solid #7b7b7b;
      border-right: medium solid #ffffff;
      border-bottom: medium solid #ffffff;
      border-left: medium solid #7b7b7b;
      border-width: 2.4px;
      background-color: #bdbdbd;
    }
    .closeBox {
      display: flex;
      width: 24px;
      height: 24px;
      border-top: medium solid #ffffff;
      border-right: medium solid #7b7b7b;
      border-bottom: medium solid #7b7b7b;
      border-left: medium solid #ffffff;
      border-width: 2px;
      background-color: #bdbdbd;
    }
    .zeroBox {
      display: flex;
      width: 26px;
      height: 26px;
      border-style: solid;
      border-color: #7b7b7b;
      border-width: 1px;
      background-color: #bdbdbd;
      
      font-family: "lilliput steps";
      font-weight: bold;
      font-size: 26px;
      justify-content: center;
      align-items: center;
    }
    .one {
      color: #0000ff;
    }
    .two {
      color: #007b00;
    }
    .three {
      color: #ff0000;
    }
    .four {
      color: #00007b;
    }
    .five {
      color: #7b0000;
    }
    .six {
      color: #007b7b;
    }
    .seven {
      color: #000000;
    }
    .eight {
      color: #7b7b7b;
    }
    
  </style>
  
<div id="borderBox">
  <div class="playBox">
      
      <div id="timeBox"></div>
      <div class="separator"></div>
      <div id="mineBox">
        <div class='closeBox' id='0'></div>
        <div class='closeBox' id='1'></div>
        <div class='closeBox' id='2'></div>
        <div class='closeBox' id='3'></div>
        <div class='closeBox' id='4'></div>
        <div class='closeBox' id='5'></div>
        <div class='closeBox' id='6'></div>
        <div class='closeBox' id='7'></div>
        <div class='closeBox' id='8'></div>
        <div class='closeBox' id='9'></div>
        <div class='closeBox' id='10'></div>
        <div class='closeBox' id='11'></div>
        <div class='closeBox' id='12'></div>
        <div class='closeBox' id='13'></div>
        <div class='closeBox' id='14'></div>
        <div class='closeBox' id='15'></div>
        <div class='closeBox' id='16'></div>
        <div class='closeBox' id='17'></div>
        <div class='closeBox' id='18'></div>
        <div class='closeBox' id='19'></div>
        <div class='closeBox' id='20'></div>
        <div class='closeBox' id='21'></div>
        <div class='closeBox' id='22'></div>
        <div class='closeBox' id='23'></div>
        <div class='closeBox' id='24'></div>
        <div class='closeBox' id='25'></div>
        <div class='closeBox' id='26'></div>
        <div class='closeBox' id='27'></div>
        <div class='closeBox' id='28'></div>
        <div class='closeBox' id='29'></div>
        <div class='closeBox' id='30'></div>
        <div class='closeBox' id='31'></div>
        <div class='closeBox' id='32'></div>
        <div class='closeBox' id='33'></div>
        <div class='closeBox' id='34'></div>
        <div class='closeBox' id='35'></div>
        <div class='closeBox' id='36'></div>
        <div class='closeBox' id='37'></div>
        <div class='closeBox' id='38'></div>
        <div class='closeBox' id='39'></div>
        <div class='closeBox' id='40'></div>
        <div class='closeBox' id='41'></div>
        <div class='closeBox' id='42'></div>
        <div class='closeBox' id='43'></div>
        <div class='closeBox' id='44'></div>
        <div class='closeBox' id='45'></div>
        <div class='closeBox' id='46'></div>
        <div class='closeBox' id='47'></div>
        <div class='closeBox' id='48'></div>
        <div class='closeBox' id='49'></div>
        <div class='closeBox' id='50'></div>
        <div class='closeBox' id='51'></div>
        <div class='closeBox' id='52'></div>
        <div class='closeBox' id='53'></div>
        <div class='closeBox' id='54'></div>
        <div class='closeBox' id='55'></div>
        <div class='closeBox' id='56'></div>
        <div class='closeBox' id='57'></div>
        <div class='closeBox' id='58'></div>
        <div class='closeBox' id='59'></div>
        <div class='closeBox' id='60'></div>
        <div class='closeBox' id='61'></div>
        <div class='closeBox' id='62'></div>
        <div class='closeBox' id='63'></div>
        <div class='closeBox' id='64'></div>
        <div class='closeBox' id='65'></div>
        <div class='closeBox' id='66'></div>
        <div class='closeBox' id='67'></div>
        <div class='closeBox' id='68'></div>
        <div class='closeBox' id='69'></div>
        <div class='closeBox' id='70'></div>
        <div class='closeBox' id='71'></div>
        <div class='closeBox' id='72'></div>
        <div class='closeBox' id='73'></div>
        <div class='closeBox' id='74'></div>
        <div class='closeBox' id='75'></div>
        <div class='closeBox' id='76'></div>
        <div class='closeBox' id='77'></div>
        <div class='closeBox' id='78'></div>
        <div class='closeBox' id='79'></div>
        <div class='closeBox' id='80'></div>

      </div>
      
    </div>
</div>
  
</body>
  <script type="text/javascript">
    var a = [
      [ 0, 1, 2, 3, 4, 5, 6, 7, 8 ],
      [ 9, 10, 11, 12, 13, 14, 15, 16, 17 ],
      [ 18, 19, 20, 21, 22, 23, 24, 25, 26 ],
      [ 27, 28, 29, 30, 31, 32, 33, 34, 35 ],
      [ 36, 37, 38, 39, 40, 41, 42, 43, 44 ],
      [ 45, 46, 47, 48, 49, 50, 51, 52, 53 ],
      [ 54, 55, 56, 57, 58, 59, 60, 61, 62 ],
      [ 63, 64, 65, 66, 67, 68, 69, 70, 71 ],
      [ 72, 73, 74, 75, 76, 77, 78, 79, 80 ]
    ];
    var opened = [
      [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
      [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
      [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
      [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
      [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
      [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
      [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
      [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
      [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ]
    ];

  var bombs = [ 1,2,3,8,9,10,18,19,20,23,31,35,27,29,57,72,80,76,50,36,37,38,60,61];

  function bomFinder(i,j) {
    var k = 0;
    for(k = 0; k < bombs.length; k++) {
      if(a[i][j] == bombs[k]) {
        return 1;
      }
    }
    return 0;
  };

  function T(i,j) {
    var t = 0, r = 0, b = 0, l = 0, tr = 0, br = 0, bl = 0, tl = 0, flagBomb = 0;
    
    if(i-1 > -1 && i-1 < 9 && j > -1 && j < 9) {
      if(bomFinder(i-1,j) == 1)
        t = 1;
      else {
        if(opened[i-1][j] == -1) {
          opened[i-1][j] = 0;
          T(i-1,j);
        }
      }
    }
    console.log('T', t);
    if(i > -1 && i < 9 && j+1 > -1 && j+1 < 9) {
      if(bomFinder(i,j+1) == 1)
        r = 1;
      else {
        if(opened[i][j+1] == -1) {
          opened[i][j+1] = 0;
          T(i,j+1);
        }
      }
    }
    console.log('R', r);
    if(i+1 > -1 && i+1 < 9 && j > -1 && j < 9) {
      if(bomFinder(i+1,j) == 1)
        b = 1;
      else {
        if(opened[i+1][j] == -1) { 
          opened[i+1][j] = 0;
          T(i+1,j);
        }
      }
    }
    console.log('B', b);
    if(i > -1 && i < 9 && j-1 > -1 && j-1 < 9) {
      if(bomFinder(i,j-1) == 1)
        l = 1;
      else {
        if(opened[i][j-1] == -1) { 
          opened[i][j-1] = 0;
          T(i,j-1);
        }
      }
    }
    console.log('L', l);

    if(i-1 > -1 && i-1 < 9 && j+1 > -1 && j+1 < 9) {
      if(bomFinder(i-1,j+1) == 1) {
        tr = 1;
      }
      else {
        if(opened[i-1][j+1] == -1) {
          if(t != 1 && r != 1) {
            opened[i-1][j+1] = 0;
            T(i-1,j+1);
          }
        }
      }
    }
    console.log('TR', tr);
    if(i+1 > -1 && i+1 < 9 && j+1 > -1 && j+1 < 9) {
      if(bomFinder(i+1,j+1) == 1) {
        br = 1;
      }
      else {
        if(opened[i+1][j+1] == -1) {
          if(b != 1 && r != 1) {
            opened[i+1][j+1] = 0;
            T(i+1,j+1);
          }
        }
      }
    }
    console.log('BR', br);
    if(i+1 > -1 && i+1 < 9 && j-1 > -1 && j-1 < 9) {
      if(bomFinder(i+1,j-1) == 1) {
        bl = 1;
      }
      else {
        if(opened[i+1][j-1] == -1) {
          if(b != 1 && l != 1) {
            opened[i+1][j-1] = 0;
            T(i+1,j-1);
          }
        }
      }
    }
    console.log('BL', bl);
    if(i-1 > -1 && i-1 < 9 && j-1 > -1 && j-1 < 9) {  
      if(bomFinder(i-1,j-1) == 1) {
        tl = 1;
      }
      else {
        if(opened[i-1][j-1] == -1) {  
          if(t != 1 && l != 1) {
            opened[i-1][j-1] = 0;
            T(i-1,j-1);
          }
        }
      }
    }
    console.log('TL', tl);

    var adjBombs = t + r + b + l + tr + br + bl + tl;
    console.log(adjBombs);



    $('#'+a[i][j]).addClass('zeroBox');
    var enclosingBombsClassEquivalent = '';
    if(adjBombs == 1)
      enclosingBombsClassEquivalent = 'one';
    if(adjBombs == 2)
      enclosingBombsClassEquivalent = 'two';
    if(adjBombs == 3)
      enclosingBombsClassEquivalent = 'three';
    if(adjBombs == 4)
      enclosingBombsClassEquivalent = 'four';
    if(adjBombs == 5)
      enclosingBombsClassEquivalent = 'five';
    if(adjBombs == 6)
      enclosingBombsClassEquivalent = 'six';
    if(adjBombs == 7)
      enclosingBombsClassEquivalent = 'seven';
    if(adjBombs == 8)
      enclosingBombsClassEquivalent = 'eight';
    
    if(adjBombs > 0) {
      console.log('#'+a[i][j]);
      $('#'+a[i][j]).addClass(enclosingBombsClassEquivalent);
      document.getElementById(a[i][j]).innerHTML = adjBombs;
    }
  };

  $('.closeBox').click(function() {
    console.log($(this).attr("id"));
    $(this).removeClass('closeBox');
    var x = parseInt($(this).attr("id"));
    var flag = 0;
    for(var i = 0; i < bombs.length; i++) {
      if(x == bombs[i]) {
        flag = 1;
        this.innerHTML = 'B';
        $(this).addClass('bomb');
        opened[parseInt(x/9)][x%9] = 0;
      }
    }
    $(this).addClass('zeroBox');
    if(flag == 0) {
      var visited = [
        [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
        [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
        [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
        [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
        [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
        [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
        [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
        [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
        [ -1, -1, -1, -1, -1, -1, -1, -1, -1 ]
      ];
      var enclosingBomb = T(parseInt(x/9),x%9,visited);
      console.log(visited);
    }
  });

  </script>
  
</html>

<!-- k = 0
(0..8).each do |i|
     (0..8).each do |j|
         puts "<div class='closeBox' id='#{k}'></div>"
         k = k + 1
     end
end -->

<!-- k = 0
(0..8).each do |i|
     print "[ "
     (0..8).each do |j|
         print "#{k}, "
         k = k + 1
     end
     puts " ]"
end -->